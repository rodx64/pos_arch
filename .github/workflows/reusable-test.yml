# ============================================
# REUSABLE WORKFLOW: Test
# Pode ser chamado por outros workflows
# ============================================
name: ğŸ”„ Reusable Test

on:
  workflow_call: # Diz que este workflow nÃ£o Ã© disparado sozinho. Ele serÃ¡ chamado por outro workflow.â€
    inputs: # Define os parÃ¢metros, como em functions. (nome, tipo, default..)
      node-version:
        type: string
        description: 'VersÃ£o do Node.js'
        required: false
        default: '18'

jobs:
  test:
    name: ğŸ§ª Run Tests
    runs-on: ubuntu-latest
    
    steps:
      - name: ğŸ“¥ Checkout
        uses: actions/checkout@v4
      
      - name: ğŸ”§ Setup Node.js ${{ inputs.node-version }}
        uses: actions/setup-node@v4
        with:
          node-version: ${{ inputs.node-version }}
          cache: 'npm'
          cache-dependency-path: fase_3/aulas/1_ci_cd/hands_on/2_aula/app/package-lock.json
      
      - name: ğŸ“¦ Install dependencies
        working-directory: fase_3/aulas/1_ci_cd/hands_on/2_aula/app
        run: npm ci
      
      - name: ğŸ§ª Run tests
        working-directory: fase_3/aulas/1_ci_cd/hands_on/2_aula/app
        run: npm test
